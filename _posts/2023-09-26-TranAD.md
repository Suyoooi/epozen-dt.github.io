---
title: "TranAD"
last_modified_at: 2023-09-26
author: 김혜원
---

본 포스팅은 시계열 데이터 이상 탐지에 트랜스포머 모델을 적용한 것에 대한 내용입니다.



모델을 이해하기 위한 설명은 이전에 작성된 포스팅들(하단 첨부)을 참고하여 주세요.

* [시계열 데이터란?](https://epozen-dt.github.io/arima-weather/)
* [트랜스포머 Encoder와 Decoder](https://epozen-dt.github.io/Transformer_Encoder,Decoder/)
* [Self-attention](https://epozen-dt.github.io/Transformer-Self-Attention/)

---


최근에는 시계열 데이터의 이상 발생 여부를 탐지하기 위해 트랜스포머(Transformer)모델이나 GAN을 많이 활용합니다. 이 모델들을 사용하면 인접한 시점 뿐만 아니라 먼 시점의 데이터 정보도 활용할 수 있기 때문에 데이터를 처리할 때 유용하다고 합니다. 이번 포스팅은 트랜스포머가 적용된 예시로 TranAD 모델을 소개합니다.

&nbsp;

![그림](data:image/png;base64,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)

&nbsp;

TranAD는 인코더 한 개와 디코더 두 개로 구성되어 있습니다. 디코더를 두 개 사용했다는 점이 기존 트랜스포머와의 차이점이고, 이 두 개의 디코더가 서로 적대적 학습을 합니다. 적대적 학습은 GAN에서 사용하는 학습 방식으로 두 개의 모델(생성기와 판별기)이 서로 경쟁을 하며 진짜에 가까운 가짜 이미지를 생성하는 것을 말합니다. 


한 에포크(학습1회)는 두 단계에 걸쳐서 진행됩니다. 첫 번째 단계에서 디코더1이 가짜 데이터를 생성하면, 두 번쨰 단계에서 디코더2가 이를 진짜인지 가짜인지 판별합니다. 

    <입력 요소>
    C : 전역적 트렌드
    W : 지역적 트렌드
    O : 입력 시퀀스 (t 시점의 데이터 | 재구축된 데이터)

&nbsp;

입력 시퀀스의 업데이트는 anomaly score를 계산하여 결정하는데 이는 USAD(Unsupervised Anomaly Detection)모델에서 사용한 방식입니다. USAD 모델은 MAML(Model-Agnostic Meta-Learning)을 하는데, 이는 모델이 바뀔 때마다 구조를 변경할 필요없이 그 구조 그대로 대부분의 모델에 적용할 수 있는 학습법입니다. 

![anomaly_score](https://hwk0702.github.io/img/usad8.png)

이 때, 산출되는 점수는 디코더1은 작아지도록, 디코더2는 커지는 것을 목적으로 학습합니다. (아래 식 참고)

![formula](https://velog.velcdn.com/images%2Fd9249%2Fpost%2F73124a06-914f-41d2-8ece-5c84eeede6e2%2FUntitled%204.png)

USAD는 오토인코더를, TranAD는 트랜스포머를 이용했다는 것이 차이점이고, 학습과정은 같습니다. 상세한 내용은 논문을 참고하여 주세요.

본 포스팅은 여기서 마칩니다.


------
> 참고

[1] [설명1](http://dmqm.korea.ac.kr/activity/seminar/394)

[2] [설명2](https://blog.csdn.net/zj_18706809267/article/details/125059124)

[3] [논문](https://arxiv.org/pdf/2201.07284.pdf)

[4] [USAD 구조](https://hwk0702.github.io/img/usad8.png)

[5] [USAD 설명](https://velog.velcdn.com/images%2Fd9249%2Fpost%2F73124a06-914f-41d2-8ece-5c84eeede6e2%2FUntitled%204.png)

[6] [USAD](https://dl.acm.org/doi/pdf/10.1145/3394486.3403392)

[7] [MAML(모델에 관계없이 진행하는 메타학습)](https://engineering-ladder.tistory.com/95)